<!doctype html>
<html lang="da">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MCD • About</title>
  <link rel="icon" href="/favicon_boosted.ico?v=1" type="image/x-icon" />
  <link rel="preconnect" href="https://unpkg.com" />
  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>

  <style>
    *,*::before,*::after{ box-sizing:border-box }
    html{ font-size:16px }
    body{
      margin:0; min-height:100vh; display:flex; flex-direction:column;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Arial,sans-serif;
      color:#fff; overflow-x:hidden;
      background:
        linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.14)),
        image-set(var(--bg-1x) 1x, var(--bg-2x) 2x),
        var(--bg);
      background-repeat:no-repeat,no-repeat,no-repeat;
      background-size:auto,cover,auto;
      background-attachment:fixed,fixed,fixed;
      background-position:center center, center top, center center;
    }
    @media (max-width:900px){ body{ background-attachment:scroll,scroll,scroll } }

    :root{
      /* Lærred/kolonner */
      --wrap: 1680px;
      --gap: 84px;
      --left-col: 520px;
      --right-col: 520px;

      /* Afstande */
      --edge-pad: 24px;
      --right-gutter: 48px;

      /* Social menu */
      --social-top: 104px;

      /* Farver/stil */
      --bg:#061a2b;
      --bg-image:url('https://byrlebjwknppjbtbkozt.supabase.co/storage/v1/object/public/backgrounds/ocean.png');
      --text:#fff; --muted:#cfd3d7; --primary:#9ad4ff;
      --card:#0b0b0c; --card-border:#2a2a2a; --shadow:0 12px 26px rgba(0,0,0,.5); --radius:16px;

      /* Nav */
      --nav-gap:14px; --nav-pad-x:14px; --nav-pad-y:8px;
      --nav-text:#fff; --nav-bg:#0d0d0f; --nav-border:#333;
      --nav-hover-bg:#151517; --nav-hover-border:#444; --nav-active:#5aa9ff;

      /* Baggrund (kan overskrives fra DB) */
      --bg-1x: var(--bg-image);
      --bg-2x: var(--bg-image);

      /* Round Council – justérbar størrelse */
      --mc-gold:#d6b35a;
      --ring-size:min(450px, 46vw);          /* ~50% af før */
      --leader-w: clamp(360px, 28vw, 480px);  /* ens bredde for lederkort */
      --leader-h: 200px;                      /* ens minimumshøjde */
      --avatar: 72px;                         /* foto-størrelse */
      --leader-side-offset: 9vw;              /* afstand fra ring (vandret) */
      --leader-vert-offset: 26%;              /* afstand over/under ring (lodret) */
    }

    /* NAV */
    .site-nav{
      position: sticky; top: 0; z-index: 9999; padding: 24px 0;
      background: transparent !important; border:0 !important; box-shadow:none !important;
    }
    .site-nav::before,.site-nav::after{ display:none !important; content:none !important; }
    .nav-inner{ padding-left:var(--edge-pad); padding-right:var(--edge-pad); }
    .site-nav nav{
      display:flex; gap:var(--nav-gap); align-items:center; flex-wrap:wrap;
      justify-content:flex-start; transform:translateY(-2px);
    }
    .site-nav nav a{
      display:inline-flex; align-items:center; justify-content:center;
      padding:var(--nav-pad-y) var(--nav-pad-x);
      color:var(--nav-text); background:var(--nav-bg); border:1px solid var(--nav-border);
      border-radius:12px; text-decoration:none; opacity:.96; box-shadow:inset 0 1px 0 rgba(255,255,255,.06);
      -webkit-tap-highlight-color:rgba(255,255,255,.15);
      font-size:1rem;
    }
    .site-nav nav a:hover{ background:var(--nav-hover-bg); border-color:var(--nav-hover-border); }
    .site-nav nav a.active,
    .site-nav nav a[aria-current="page"]{
      border-color:var(--nav-active);
      box-shadow:0 0 0 2px color-mix(in srgb, var(--nav-active) 25%, transparent) inset;
    }

    /* Sociale links */
    .social-menu{
      position:fixed; top:var(--social-top); left:var(--edge-pad);
      display:flex; flex-direction:column; gap:10px; z-index:1000;
    }
    .social-menu a{
      display:flex; align-items:center; justify-content:center;
      width:42px; height:42px; background:rgba(0,0,0,.7); border-radius:8px;
      text-decoration:none; transition:background-color .2s, transform .15s;
    }
    .social-menu a:hover{ background:rgba(0,0,0,.85); transform:translateY(-2px); }
    .social-menu a img{ width:22px; height:22px }

    /* Grid layout */
    .layout{
      max-width:var(--wrap); margin:0 auto; padding:24px var(--edge-pad);
      display:grid; grid-template-columns: var(--left-col) 1fr var(--right-col);
      grid-auto-rows:auto; gap:var(--gap); align-items:start; flex:1; position:relative; z-index:0;
    }

    /* Kort */
    .card{ background:var(--card); border:1px solid var(--card-border); border-radius:var(--radius); box-shadow:var(--shadow), inset 0 1px 0 rgba(255,255,255,.06) }
    .card.pad{ padding:18px }
    h1{ font-size:clamp(22px,2.6vw,26px); line-height:1.25; margin:0 0 .5em; }
    h2{ margin:0 0 10px; font-size:clamp(18px,2.2vw,22px) }
    .muted{ color:var(--muted) }

    /* Venstre/højre kolonne */
    #about-info{ grid-column:1; }
    .right-col{ grid-column:3; margin-top:36px; margin-left:8px; padding-right: var(--right-gutter); position: relative; z-index: 0; }
    .right-col .card{ width:100% }
    .right-col #right-main .muted{ min-height: 8rem; }

    /* === COUNCIL – spænder hele bredden === */
    .council{ grid-column:1 / -1; display:flex; flex-direction:column; align-items:center; gap:18px; }

    .rc-head{ width:100%; max-width:1200px; display:flex; align-items:center; justify-content:space-between; gap:16px; }
    .rc-sub{ color:var(--muted); margin:.25rem 0 0; }

    .rc-board{
      position:relative; width:var(--ring-size); aspect-ratio:1/1; margin:6px auto 42px;
      border-radius:999px;
      background:
        radial-gradient(closest-side, rgba(214,179,90,.16), transparent 60%),
        radial-gradient(closest-side, rgba(214,179,90,.08), transparent 76%),
        radial-gradient(closest-side, rgba(214,179,90,.05), transparent 90%),
        #0f1319;
      box-shadow:0 0 0 1px rgba(214,179,90,.25) inset, 0 40px 80px rgba(0,0,0,.35);
      overflow:visible;
    }
    .rc-center{
      position:absolute; inset:50% auto auto 50%; transform:translate(-50%,-50%);
      background:linear-gradient(180deg, #151a21, #0f1319);
      border:1px solid var(--card-border); border-radius:20px; padding:18px 20px;
      width:min(62%, 520px); text-align:center; box-shadow:var(--shadow);
    }
    .rc-center h3{ margin:.2rem 0 .25rem; font-size:clamp(16px,2.2vw,20px) }
    .rc-center p{ margin:.1rem 0 .5rem; color:var(--muted); font-size:.95rem }
    .rc-center a{
      display:inline-block; padding:8px 12px; border-radius:12px;
      border:1px solid var(--mc-gold); color:var(--text); text-decoration:none;
      background:linear-gradient(180deg, rgba(214,179,90,.22), rgba(214,179,90,.08));
    }

    /* Lederkort – udenfor ringen, ENS STØRRELSE */
    .leader{
      position:absolute;
      width:var(--leader-w);
      min-height:var(--leader-h);
      display:grid;
      grid-template-columns:auto 1fr;
      grid-template-rows:auto 1fr;
      gap:12px 14px;
      align-content:start;

      background:linear-gradient(180deg, #151a21, #10151b);
      border:1px solid var(--card-border);
      border-radius:18px;
      padding:16px;
      box-shadow:var(--shadow);
    }
    .leader .top{
      grid-column:1 / -1;
      display:grid; grid-template-columns: var(--avatar) 1fr; align-items:center; column-gap:14px;
      margin:0;
    }
    .leader img{
      width:var(--avatar); height:var(--avatar);
      border-radius:50%; object-fit:cover; border:1px solid var(--card-border)
    }
    .leader .nm{ font-weight:700; letter-spacing:.2px; font-size:1.05rem; line-height:1.2 }
    .leader .ti{ color:var(--muted); font-size:.96rem; margin-top:2px }
    .leader ul{
      grid-column:1 / -1; list-style:disc; margin:.25rem 0 0 1.2rem;
      color:var(--muted); line-height:1.4;
    }
    .leader ul li{ margin:.22rem 0 }

    /* Forbindelseslinjer fra kort til ring */
    .leader::after{ content:""; position:absolute; pointer-events:none; opacity:.9; }

    .leader.pos-n{
      left:50%; top: calc(-1 * var(--leader-vert-offset)); transform:translate(-50%,0);
    }
    .leader.pos-n::after{
      left:50%; top:100%; transform:translateX(-50%); width:2px; height:24px;
      background:linear-gradient(180deg, rgba(214,179,90,.85), rgba(214,179,90,0));
    }

    .leader.pos-s{
      left:50%; bottom: calc(-1 * var(--leader-vert-offset)); transform:translate(-50%,0);
    }
    .leader.pos-s::after{
      left:50%; bottom:100%; transform:translateX(-50%); width:2px; height:24px;
      background:linear-gradient(0deg, rgba(214,179,90,.85), rgba(214,179,90,0));
    }

    .leader.pos-w{
      right: calc(100% + var(--leader-side-offset)); top:50%; transform:translateY(-50%);
    }
    .leader.pos-w::after{
      left:100%; top:50%; transform:translateY(-50%); width:28px; height:2px;
      background:linear-gradient(90deg, rgba(214,179,90,.85), rgba(214,179,90,0));
    }

    .leader.pos-e{
      left: calc(100% + var(--leader-side-offset)); top:50%; transform:translateY(-50%);
    }
    .leader.pos-e::after{
      right:100%; top:50%; transform:translateY(-50%); width:28px; height:2px;
      background:linear-gradient(90deg, rgba(214,179,90,0), rgba(214,179,90,.85));
    }

    /* Teams */
    .rc-teams{
      display:flex; gap:10px; justify-content:center; flex-wrap:wrap;
      margin:6px auto 0; max-width:1200px;
    }
    .chip{ border:1px solid var(--card-border); background:#0f141a; color:#cfd3d7; padding:6px 10px; border-radius:999px; font-size:.9rem; }

    /* PROJEKTMANAGER – under ledelsen */
    .pm{
      width:100%; max-width:1200px; margin:10px auto 0;
      background:linear-gradient(180deg, #10151b, #0f1319);
      border:1px solid var(--card-border); border-radius:18px; padding:16px; box-shadow:var(--shadow);
    }
    .pm .row{ display:flex; align-items:center; gap:14px; }
    .pm .row img{ width:58px; height:58px; border-radius:50%; object-fit:cover; border:1px solid var(--card-border) }
    .pm .muted{ color:var(--muted); }

    /* PARTNERS */
    .partners{ margin: 8px auto 0; padding: 18px 0 8px; }
    .partners-title{ margin: 0 0 10px; font-size: clamp(16px, 1.8vw, 18px); color: #cfd3d7; opacity: .95; }
    .partners-list{ display:flex; flex-wrap:wrap; gap:18px; align-items:center; border-top:1px solid rgba(255,255,255,.06); padding-top:14px; }
    .partner{ display:inline-flex; align-items:center; justify-content:center; width:120px; height:54px; padding:8px 10px; background:#0d0d0f; border:1px solid #2a2a2a; border-radius:12px; box-shadow: inset 0 1px 0 rgba(255,255,255,.04); transition: transform .15s ease, filter .15s ease, background .15s ease; }
    .partner:hover{ transform: translateY(-1px); filter: brightness(1.08); }
    .partner img{ max-width:100%; max-height:100%; display:block; object-fit:contain; filter: saturate(.9) contrast(1.05); }

    /* Footer */
    .site-footer{ margin-top:auto; padding:12px 16px; color:#fff; text-align:center; background:rgba(0,0,0,.75); border-top:1px solid rgba(255,255,255,.06); }

    /* MOBIL */
    .m-hero{ display:none; }
    .m-hero .box{ background:#0b0b0c; border:1px solid #2a2a2a; border-radius:16px; box-shadow:0 12px 26px rgba(0,0,0,.5), inset 0 1px 0 rgba(255,255,255,.06); padding:16px 18px; margin:8px auto 10px; width:calc(100vw - 32px); }
    .m-hero .ribbon{ display:inline-block; margin:-2px 0 8px; padding:4px 10px; border-radius:999px; font-size:12px; background:#102414; border:1px solid #1d3d22; color:#baf7c9; box-shadow:inset 0 1px 0 rgba(255,255,255,.06) }
    .m-hero h1{ font-size:clamp(18px,6.2vw,22px); margin:.1rem 0 .4rem }
    .m-hero p{ color:#cfd3d7; margin:.25rem 0 .6rem; font-size:.95rem }
    .m-hero .btns{ display:flex; gap:10px; flex-wrap:wrap }
    .m-hero .btn{ display:inline-flex; align-items:center; justify-content:center; gap:8px; padding:8px 12px; border-radius:12px; text-decoration:none; cursor:pointer; background:#0d0d0f; border:1px solid #333; color:#fff; box-shadow:inset 0 1px 0 rgba(255,255,255,.06); }
    .m-hero .btn.primary{ background:linear-gradient(135deg,#FFD700,#DAA520); color:#1c2630; border-color:#865c10 }

    @media (max-width: 1200px){
      /* træk sidekortene lidt ind når pladsen er mindre */
      :root{ --leader-side-offset: 5vw; }
    }

    @media (max-width: 900px){
      body{ font-size: .95rem; }
      h1{ font-size: clamp(18px, 6.2vw, 22px); }
      h2{ font-size: clamp(16px, 5.2vw, 20px); }
      :root{ --social-top: 116px; --ring-size:min(360px, 74vw); --leader-w:92vw; --leader-h:auto; }

      .layout{ grid-template-columns: 1fr; grid-auto-flow: row; gap: 18px;
        padding: 12px 16px 24px; padding-left: calc(16px + 76px); }
      .layout > *{ grid-column: 1 !important; min-width: 0; }
      .right-col{ margin: 0; padding: 0; }
      .right-col .card{ width:100%; margin:0; box-sizing:border-box; }
      .site-nav{ padding: 16px 0; }
      .nav-inner{ padding-left:16px; padding-right:24px; }

      /* På mobil vises lederkort i liste under ringen */
      .rc-board{ margin-bottom:12px; }
      .leader{ position:static; width:100%; transform:none !important; margin:8px 0; }
      .leader::after{ display:none; }
      .rc-teams{ justify-content:flex-start; }
    }
  </style>
</head>
<body>
  <!-- NAV -->
  <header class="site-nav">
    <div class="nav-inner">
      <nav class="nav">
        <a href="/" data-text="common:nav_home">Home</a>
        <a href="/about" data-text="common:nav_about">About</a>
        <a href="/roadmap" data-text="common:nav_roadmap">Roadmap</a>
        <a href="/reports" data-text="common:nav_reports">Reports</a>
      </nav>
    </div>
  </header>

  <!-- VENSTRE: Sociale links -->
  <div class="social-menu" id="social-menu"></div>

  <!-- MOBIL HERO (kun mobil) -->
  <section class="m-hero" aria-hidden="true">
    <div class="box">
      <div class="ribbon" data-text="about:hero_ribbon">NGO</div>
      <h1 data-text="about:hero_title">Om MCD (NGO)</h1>
      <p data-text="about:hero_sub">Lokale projekter, gennemsigtighed og ansvarlig ledelse.</p>
      <div class="btns">
        <a class="btn primary" href="/reports" data-text="about:hero_cta_secondary">Se rapporter</a>
      </div>
    </div>
  </section>

  <!-- GRID -->
  <div class="layout">
    <!-- Venstre kolonne -->
    <article class="card pad" id="about-info">
      <h2 data-text="about:bio_top_title">Om NGO’en</h2>
      <div class="muted" data-text="about:bio_top">
        NGO’en ledes af et råd på fire personer. Rådet godkender alle afgørelser. Projektmanageren faciliterer og rapporterer til rådet.
      </div>
    </article>

    <!-- COUNCIL – spænder hele bredden -->
    <section class="council">
      <div class="rc-head">
        <div>
          <h2 data-text="about:council_title">Rådet (4 ledere)</h2>
        <div class="rc-sub" data-text="about:council_sub">Beslutninger tages i fællesskab af fire ligestillede ledere.</div>
        </div>
      </div>

      <div class="rc-board" id="rc-board">
        <!-- CENTER: Charter/Vedtægter -->
        <div class="rc-center">
          <h3 data-text="about:charter_title">Charter & Vedtægter</h3>
          <p data-text="about:charter_sub">Gennemsigtighed, uafhængighed og ansvarlig forvaltning.</p>
          <a id="charter-link" href="#" target="_blank" rel="noopener" data-text="about:charter_btn">Læs dokument</a>
        </div>

        <!-- LEDERE (udenfor ringen). N = admin-trigger -->
        <article class="leader pos-n" id="leader-n" data-admin="true" role="button" tabindex="0" aria-label="Åbn admin-login">
          <div class="top">
            <img id="leader-n-img" alt="Leder N">
            <div>
              <div class="nm" id="leader-n-name">Julienne</div>
              <div class="ti" id="leader-n-title">Leder</div>
            </div>
          </div>
          <ul id="leader-n-points">
            <li>Overordnet tilsyn</li>
            <li>Underskriftsret</li>
          </ul>
        </article>

        <article class="leader pos-e" id="leader-e">
          <div class="top">
            <img id="leader-e-img" alt="Leder Øst">
            <div>
              <div class="nm" id="leader-e-name">Leder Øst</div>
              <div class="ti" id="leader-e-title">Leder</div>
            </div>
          </div>
          <ul id="leader-e-points">
            <li>Projektprioritering</li>
            <li>Lokale leverandører</li>
          </ul>
        </article>

        <article class="leader pos-s" id="leader-s">
          <div class="top">
            <img id="leader-s-img" alt="Leder Syd">
            <div>
              <div class="nm" id="leader-s-name">Leder Syd</div>
              <div class="ti" id="leader-s-title">Leder</div>
            </div>
          </div>
          <ul id="leader-s-points">
            <li>Budget & rapporter</li>
            <li>Risiko & compliance</li>
          </ul>
        </article>

        <article class="leader pos-w" id="leader-w">
          <div class="top">
            <img id="leader-w-img" alt="Leder Vest">
            <div>
              <div class="nm" id="leader-w-name">Leder Vest</div>
              <div class="ti" id="leader-w-title">Leder</div>
            </div>
          </div>
          <ul id="leader-w-points">
            <li>Community & kommunikation</li>
            <li>Partnere</li>
          </ul>
        </article>
      </div>

      <!-- Teams -->
      <div class="rc-teams" id="rc-teams">
        <span class="chip">Finans</span>
        <span class="chip">Revision</span>
        <span class="chip">Projekter</span>
        <span class="chip">Community</span>
      </div>

      <!-- Projektmanager (under ledelsen) -->
      <div class="pm">
        <div class="row">
          <img id="pm-photo-inline" alt="Projektmanager">
          <div>
            <div style="font-weight:700" id="pm-name-inline">Thomas</div>
            <div class="muted" id="pm-role-inline">Projektmanager · rapporterer til Rådet (ingen økonomisk råderet)</div>
          </div>
        </div>
      </div>
    </section>

    <!-- Højre kolonne -->
    <aside class="right-col">
      <div class="card pad" id="right-main">
        <h2 data-text="about:right_title">Mission & principper</h2>
        <div class="muted" data-text="about:right_body">
          NGO’en arbejder uafhængigt af MCN (firmaet). Denne side viser kun NGO-indhold.
        </div>
      </div>
    </aside>
  </div>

  <!-- Samarbejdspartnere -->
  <section class="partners wrap" id="partners" style="padding: 0 var(--edge-pad) 24px;">
    <h3 class="partners-title">Samarbejdspartnere</h3>
    <div class="partners-list" id="partners-list" aria-label="Samarbejdspartnere"></div>
  </section>

  <footer class="site-footer">
    <span data-text="common:footer">© 2025 MadaCoin. All rights reserved.</span>
  </footer>

  <!-- ADMIN LOGIN MODAL -->
  <div class="modal" id="admin-modal" aria-hidden="true" style="position:fixed;inset:0;background:rgba(0,0,0,.5);display:none;align-items:center;justify-content:center;z-index:9999">
    <div class="sheet" style="width:min(420px,92vw);background:#0f1423;border:1px solid #2a3a55;border-radius:16px;padding:18px">
      <div class="row" style="display:flex;gap:10px;align-items:center;justify-content:space-between">
        <h3 style="margin:0">Admin login</h3>
        <button class="x" id="mdl-close" aria-label="Luk" style="border:none;background:transparent;color:#9ccfff;font-size:22px;line-height:1;cursor:pointer">×</button>
      </div>
      <p class="small" style="font-size:13px;color:#a9b4c8;margin:.25rem 0 .75rem">Kun for godkendte administratorer.</p>
      <label style="display:block;margin:6px 0;color:#cfe3ff">Email
        <input id="adm-email" type="email" placeholder="you@madacoin.pro" style="width:100%;padding:10px;border-radius:10px;border:1px solid #2b3f5e;background:#0b1221;color:#fff" />
      </label>
      <label style="display:block;margin:6px 0;color:#cfe3ff">Kodeord
        <input id="adm-pass" type="password" placeholder="••••••••" style="width:100%;padding:10px;border-radius:10px;border:1px solid #2b3f5e;background:#0b1221;color:#fff" />
      </label>
      <div class="row" style="display:flex;gap:10px;align-items:center;justify-content:flex-end;margin-top:10px">
        <button class="btn" id="mdl-cancel" style="cursor:pointer;border-radius:10px;border:1px solid #2f4a6a;background:#0f1a2b;color:#fff;padding:10px 12px">Annullér</button>
        <button class="btn primary" id="mdl-login" style="cursor:pointer;border-radius:10px;border:1px solid #27608a;background:linear-gradient(135deg,#8bd5ff,#66c2ff);color:#0b2236;padding:10px 12px;font-weight:700">Log ind</button>
      </div>
      <div id="adm-msg" class="small" style="margin-top:8px;color:#ff9aa3;font-size:13px"></div>
    </div>
  </div>

  <script>
    /* ===== Supabase klient ===== */
    const SUPABASE_URL = "https://byrlebjwknppjbtbkozt.supabase.co";
    const SUPABASE_ANON = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJ5cmxlYmp3a25wcGpidGJrb3p0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE3NjcyNjYsImV4cCI6MjA2NzM0MzI2Nn0.3aoQMQgmxXouUfpqrwfSgcUgedjZEue6s3ZkGoqvQYY";
    const sb = window.supabase ? window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON) : null;

    /* ===== Aktiv menumarkering ===== */
    (function markActive(){
      try{
        const here = location.pathname.replace(/\/index\.html?$/,'/');
        document.querySelectorAll('header .nav a').forEach(a=>{
          const to = a.getAttribute('href');
          if (to === here || (here === '/' && to === '/')) a.setAttribute('aria-current','page');
          else a.removeAttribute('aria-current');
        });
      }catch(e){}
    })();

    /* ===== Site-tekster (common + about) ===== */
    (async function(){
      if(!sb) return;
      try{
        const { data } = await sb.from('site_text').select('page,key,value').in('page',['common','about']);
        const dict={}; (data||[]).forEach(r=>dict[`${r.page}:${r.key}`]=r.value);
        document.querySelectorAll('[data-text]').forEach(el=>{
          const k=el.getAttribute('data-text'); if(dict[k]!=null) el.innerHTML=dict[k];
        });

        // Charter-link fra about:charter_url
        const cl = dict['about:charter_url'];
        if(cl){ const a=document.getElementById('charter-link'); if(a) a.href = cl; }
        // Teams (komma-sep i about:teams)
        const teams = (dict['about:teams']||'').split(',').map(s=>s.trim()).filter(Boolean);
        if(teams.length){
          const wrap=document.getElementById('rc-teams'); wrap.innerHTML='';
          teams.forEach(t=>{ const span=document.createElement('span'); span.className='chip'; span.textContent=t; wrap.appendChild(span); });
        }
      }catch(e){ console.warn('[about] site_text', e); }
    })();

    /* ===== Baggrund pr. side (site_settings) ===== */
    async function applyBackgroundForPage(pageKey='about'){
      if(!sb) return;
      try{
        const keys=[`bg_${pageKey}_1x`,`bg_${pageKey}_2x`,`bg_default_1x`,`bg_default_2x`];
        const { data } = await sb.from('site_settings').select('key,value').in('key', keys);
        const map = Object.fromEntries((data||[]).map(r=>[r.key,r.value]));
        const one = map[`bg_${pageKey}_1x`] || map['bg_default_1x'] || '';
        const two = map[`bg_${pageKey}_2x`] || map['bg_default_2x'] || '';
        if(one) document.body.style.setProperty('--bg-1x', `url("${one}")`);
        if(two) document.body.style.setProperty('--bg-2x', `url("${two}")`);
      }catch(e){ console.warn('[about] background', e); }
    }
    applyBackgroundForPage('about');

    /* ===== Sociale links ===== */
    function normalizeUrl(u){ if(!u) return null; const t=u.trim(); return /^https?:\/\//i.test(t)?t:'https://'+t }
    function iconUrlFor(p){
      if(!sb) return null;
      const name=p.charAt(0).toUpperCase()+p.slice(1).toLowerCase();
      const {data}=sb.storage.from('social.icons').getPublicUrl(`${name}.svg`);
      return data?.publicUrl||null
    }
    function fallbackIconUrl(){
      if(!sb) return '';
      const {data}=sb.storage.from('social.icons').getPublicUrl('Globe.svg');
      return data?.publicUrl||''
    }
    async function renderSocialLinks(){
      const el=document.getElementById('social-menu'); if(!el||!sb) return;
      el.innerHTML='';
      const {data}=await sb.from('social_links').select('platform,url,is_active,sort_order')
        .eq('is_active',true).order('sort_order',{ascending:true});
      const globe=fallbackIconUrl();
      (data||[]).filter(r=>r.url&&r.url.trim()!=='').forEach(r=>{
        const a=document.createElement('a'); const href=normalizeUrl(r.url); if(!href) return;
        a.href=href; a.target='_blank'; a.rel='noopener noreferrer'; a.title=r.platform; a.setAttribute('aria-label',r.platform);
        const img=document.createElement('img'); img.src=iconUrlFor(r.platform)||globe; img.onerror=()=>{img.src=globe}; a.appendChild(img); el.appendChild(a);
      });
    }

    /* ===== Personer til Rådet + PM (HUSK BILLEDER) ===== */
    (async function(){
      if(!sb) { simpleFallbackImages(); return; }
      try{
        const wanted = ['leader_n','leader_e','leader_s','leader_w','pm'];
        const legacy = ['top','mid','accounting','sub1','sub2','sub3'];
        const pplRes = await sb.from('org_people')
          .select('slot,name,title,photo_url,bio')
          .or(`slot.in.(${wanted.join(',')}),slot.in.(${legacy.join(',')})`);
        const ppl = pplRes.data||[];
        const bySlot={}; ppl.forEach(x=>bySlot[x.slot]=x);

        const STORAGE_BASE = SUPABASE_URL.replace(/\/+$/,'') + '/storage/v1/object/public';
        const ph = (p)=> STORAGE_BASE + p; // helper

        function setLeader(prefix, p, fallbackUrl){
          const img = document.getElementById(`${prefix}-img`);
          const nm  = document.getElementById(`${prefix}-name`);
          const ti  = document.getElementById(`${prefix}-title`);
          if(img) img.src = (p?.photo_url && p.photo_url.trim()) ? p.photo_url : fallbackUrl;
          if(nm && (p?.name)) nm.textContent = p.name;
          if(ti && (p?.title)) ti.textContent = p.title;
        }

        setLeader('leader-n', bySlot['leader_n'] || bySlot['top'] || null, ph('/people/Owner.jpg'));
        setLeader('leader-e', bySlot['leader_e'] || bySlot['sub1'] || null, ph('/people/LeaderE.jpg'));
        setLeader('leader-s', bySlot['leader_s'] || bySlot['accounting'] || null, ph('/people/Revision.jpg'));
        setLeader('leader-w', bySlot['leader_w'] || bySlot['sub2'] || null, ph('/people/LeaderW.jpg'));

        // PM under Rådet
        const pm = bySlot['pm'] || bySlot['mid'] || null;
        const pmUrl = (pm?.photo_url && pm.photo_url.trim()) ? pm.photo_url : ph('/people/ADM.jpg');
        const pmImg = document.getElementById('pm-photo-inline');
        if(pmImg) pmImg.src = pmUrl;
        if(pm?.name){ const n=document.getElementById('pm-name-inline'); if(n) n.textContent=pm.name; }
        if(pm?.title){ const r=document.getElementById('pm-role-inline'); if(r) r.textContent=pm.title + ' · rapporterer til Rådet'; }

      }catch(e){
        console.warn('[about] org_people', e);
        simpleFallbackImages();
      }
    })();

    function simpleFallbackImages(){
      const base = SUPABASE_URL.replace(/\/+$/,'') + '/storage/v1/object/public';
      const fb = {
        n: base+'/people/Owner.jpg',
        e: base+'/people/LeaderE.jpg',
        s: base+'/people/Revision.jpg',
        w: base+'/people/LeaderW.jpg',
        pm: base+'/people/ADM.jpg'
      };
      [['leader-n-img','n'],['leader-e-img','e'],['leader-s-img','s'],['leader-w-img','w']]
        .forEach(([id,k])=>{ const el=document.getElementById(id); if(el) el.src=fb[k]; });
      const pmImg = document.getElementById('pm-photo-inline');
      if(pmImg) pmImg.src = fb.pm;
    }

    /* ===== Partners strip ===== */
    (async function(){
      if(!sb) return;
      const elSection = document.getElementById('partners');
      const elList = document.getElementById('partners-list');
      if(!elSection || !elList) return;
      try{
        const { data, error } = await sb
          .from('partners')
          .select('id,name,website,logo_url,logo_alt,active')
          .eq('active', true)
          .order('name', { ascending: true })
          .limit(12);
        if(error || !data?.length){ elSection.style.display='none'; return; }
        data.forEach(p=>{
          const a=document.createElement('a'); a.className='partner';
          a.href=p.website||'#'; a.target='_blank'; a.rel='noopener noreferrer'; a.title=p.name||'Partner';
          const img=document.createElement('img'); img.alt=p.logo_alt||p.name||'Partner logo';
          img.src=(p.logo_url&&p.logo_url.trim())?p.logo_url:(SUPABASE_URL.replace(/\/+$/,'') + '/storage/v1/object/public/people/Revision.jpg');
          a.appendChild(img); elList.appendChild(a);
        });
      }catch(e){ console.warn('[partners] exception:', e); }
    })();

    /* ===== Admin modal – N-leder (Julienne) er “trykknap” ===== */
    const $ = s=>document.querySelector(s);
    const modal = $('#admin-modal');
    const openModal = ()=>{ modal.style.display='flex'; modal.setAttribute('aria-hidden','false'); $('#adm-email')?.focus(); };
    const closeModal = ()=>{ modal.style.display='none'; modal.setAttribute('aria-hidden','true'); $('#adm-msg').textContent=''; };
    $('#mdl-close')?.addEventListener('click', closeModal);
    $('#mdl-cancel')?.addEventListener('click', closeModal);

    const adminTrigger = document.getElementById('leader-n');
    if(adminTrigger){
      adminTrigger.addEventListener('click', openModal);
      adminTrigger.addEventListener('keydown', (e)=>{ if(e.key==='Enter' || e.key===' '){ e.preventDefault(); openModal(); }});
    }

    async function isAdmin(session){
      if(!session) return false;
      const { data, error } = await sb.from('admins').select('id').eq('id', session.user.id).maybeSingle();
      return !!data && !error;
    }
    $('#mdl-login')?.addEventListener('click', async ()=>{
      $('#adm-msg').textContent='';
      const email=$('#adm-email').value.trim(), pass=$('#adm-pass').value;
      const { error } = await sb.auth.signInWithPassword({ email, password: pass });
      if(error){ $('#adm-msg').textContent = error.message; return; }
      const { data:{session} } = await sb.auth.getSession();
      if(!(await isAdmin(session))){ $('#adm-msg').textContent='Ingen adgang.'; await sb.auth.signOut(); return; }
      window.location.href = '/adm';
    });

    /* Init: sociale links */
    window.addEventListener('load', renderSocialLinks);
  </script>
</body>
</html>
