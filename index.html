<!DOCTYPE html>
<html lang="da">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>MadaCoin</title>
  <meta name="description" content="MadaCoin støtter udvikling i Madagaskar gennem donationer og gennemsigtighed. Følg projektet og vores roadmap.">
  <link rel="icon" href="/favicon_boosted.ico?v=1" type="image/x-icon">

  <!-- Open Graph -->
  <meta property="og:title" content="MadaCoin — Donations for Madagascar">
  <meta property="og:description" content="Støt udvikling i Madagaskar gennem MadaCoin.">
  <meta property="og:url" content="https://madacoin.pro">
  <meta property="og:type" content="website">

  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="MadaCoin — Donations for Madagascar">
  <meta name="twitter:description" content="Støt udvikling i Madagaskar gennem MadaCoin.">

  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>

  <style>
    *,*::before,*::after{ box-sizing:border-box }
    html{ font-size:16px }
    body{
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Arial,sans-serif;
      font-size:1rem; line-height:1.5; margin:0; padding:0; color:#fff;
      background:#061a2b no-repeat center/cover fixed;
      background-image:url('https://byrlebjwknppjbtbkozt.supabase.co/storage/v1/object/public/backgrounds/ocean.png');
      overflow-x:hidden;
    }
    @media (max-width:800px){ body{ background-attachment:scroll } }

    h1{ font-size:clamp(22px,2.6vw,26px); line-height:1.25; margin:0 0 .5em }
    h2{ font-size:clamp(18px,2.2vw,22px); line-height:1.3; margin:0 0 .5em }
    h3{ font-size:clamp(16px,1.8vw,18px); line-height:1.35; margin:0 0 .5em }

    :root{
      --edge-pad:24px;
      --nav-gap:14px; --nav-pad-x:14px; --nav-pad-y:8px;
      --nav-text:#fff; --nav-bg:#0d0d0f; --nav-border:#333;
      --nav-hover-bg:#151517; --nav-hover-border:#444; --nav-active:#5aa9ff;
      --social-top:104px;

      /* Hero (desktop) */
      --hero-top:118px; --hero-left-offset:66px; --hero-width:clamp(320px,30vw,520px);
    }

    /* Øen */
    .madagascar-container{ position:absolute; top:0%; left:52%; transform:translateX(-50%); z-index:1; }
    .madagascar-container img{ width:90vw; max-width:600px; height:auto; border-radius:10px }

    /* NAV */
    .site-nav{ position:sticky; top:0; z-index:9999; padding:24px 0; background:transparent!important }
    .site-nav::before,.site-nav::after{ display:none!important; content:none!important }
    .site-nav .nav-inner{ padding-left:var(--edge-pad); padding-right:var(--edge-pad) }
    .nav{ display:flex; gap:var(--nav-gap); align-items:center; flex-wrap:wrap; justify-content:flex-start; transform:translateY(-2px) }
    .nav a{
      display:inline-flex; align-items:center; justify-content:center;
      padding:var(--nav-pad-y) var(--nav-pad-x);
      color:var(--nav-text); background:var(--nav-bg); border:1px solid var(--nav-border);
      border-radius:12px; text-decoration:none; opacity:.96; box-shadow:inset 0 1px 0 rgba(255,255,255,.06)
    }
    .nav a:hover{ background:var(--nav-hover-bg); border-color:var(--nav-hover-border) }
    .nav a[aria-current="page"]{ border-color:var(--nav-active); box-shadow:0 0 0 2px color-mix(in srgb, var(--nav-active) 25%, transparent) inset }

    /* Social */
    .social-menu{ position:fixed; top:var(--social-top); left:var(--edge-pad); display:flex; flex-direction:column; gap:10px; z-index:1000 }
    .social-menu a{ display:flex; align-items:center; justify-content:center; width:42px; height:42px; background:rgba(0,0,0,.7); border-radius:8px; text-decoration:none; transition:background-color .2s, transform .15s }
    .social-menu a:hover{ background:rgba(0,0,0,.85); transform:translateY(-2px) }
    .social-menu a img{ width:22px; height:22px }

    /* HERO */
    .hero{
      position:absolute; top:var(--hero-top);
      left:calc(var(--edge-pad) + var(--hero-left-offset));
      width:var(--hero-width); z-index:3;
      background:#0b0b0c; border:1px solid #2a2a2a; border-radius:16px;
      box-shadow:0 12px 26px rgba(0,0,0,.5), inset 0 1px 0 rgba(255,255,255,.06);
      padding:16px 18px;
    }
    .hero .ribbon{
      display:inline-block; margin:-2px 0 8px; padding:4px 10px; border-radius:999px; font-size:12px; letter-spacing:.2px;
      background:#102414; border:1px solid #1d3d22; color:#baf7c9; box-shadow:inset 0 1px 0 rgba(255,255,255,.06)
    }
    .hero .sub{ color:#cfd3d7; margin:.25rem 0 .5rem }
    .hero .points{ display:flex; flex-wrap:wrap; gap:6px 8px; margin:.5rem 0 .75rem }
    .hero .pt{ padding:6px 10px; border-radius:999px; background:#0d0d0f; border:1px solid #333; box-shadow:inset 0 1px 0 rgba(255,255,255,.06); font-size:.9rem; opacity:.96 }
    .hero .btns{ display:flex; gap:10px; flex-wrap:wrap }
    .hero .btn{
      display:inline-flex; align-items:center; justify-content:center; gap:8px;
      padding:9px 14px; border-radius:12px; text-decoration:none; cursor:pointer;
      background:#0d0d0f; border:1px solid #333; color:#fff; box-shadow:inset 0 1px 0 rgba(255,255,255,.06);
      transition:filter .15s, transform .15s
    }
    .hero .btn:hover{ filter:brightness(1.08); transform:translateY(-1px) }
    .hero .btn.primary{ background:linear-gradient(135deg,#FFD700,#DAA520); color:#1c2630; border-color:#865c10 }
    .hero .perks{ margin-top:.6rem; font-size:.9rem; color:#cfd3d7 }
    .hero .perks a{ color:#9ad4ff; text-decoration:none }
    .hero .perks a:hover{ text-decoration:underline }

    @media (max-width:1200px){
      .hero{ position:static; width:min(92vw,720px); margin:8px auto 0 }
    }

    /* Indhold (som før) */
    .wrap{ max-width:1100px; margin:0 auto; padding:24px }
    .content-box{ padding:10px 10px 1px; border-radius:20px; margin:400px auto 10px; max-width:1000px }
    .coin-section{ display:flex; flex-wrap:wrap; justify-content:center; gap:200px; margin-top:10px; padding-top:25px }
    .coin{ background:rgba(255,248,220,.95); margin:10px; padding:10px; border-radius:15px; width:320px; text-align:center; box-shadow:0 0 12px rgba(0,0,0,.1); border:2px solid #e5c100 }
    .coin img{ width:300px; height:300px; border-radius:10px; margin-bottom:10px; object-fit:cover }
    .coin-description{ font-size:.9rem; margin-bottom:10px; color:#333 }
    .button{ background:linear-gradient(135deg,#FFD700,#DAA520); color:#004d73!important; padding:10px 20px; border:none; margin-top:10px; cursor:pointer; border-radius:5px; font-weight:bold; box-shadow:0 4px 8px rgba(0,0,0,.2); transition:all .3s }
    .button:hover{ background:linear-gradient(135deg,#FFC107,#B8860B); transform:scale(1.05) }

    .roadmap{ margin:40px auto; max-width:800px; padding:0 20px; display:flex; flex-direction:column; align-items:center }
    .roadmap-box{ background:rgba(255,248,220,.95); padding:15px 50px; border-radius:20px; border:2px solid #e5c100; box-shadow:0 0 12px rgba(0,0,0,.1); display:flex; flex-direction:column; gap:10px; margin-bottom:30px; width:100%; max-width:700px }
    .roadmap-box h2{ margin:0; color:#444; font-size:1.2rem }
    .description{ font-size:.8rem; margin:0; color:#555 }
    .step-images{ display:flex; flex-wrap:wrap; gap:10px; max-width:100%; justify-content:flex-start; margin-top:10px }
    .step-images img{ width:80px; height:80px; object-fit:cover; cursor:pointer; margin:5px; transition:transform .3s }
    .roadmap-thumb{ cursor:zoom-in }

    /* Lightbox */
    #rm-lightbox{ position:fixed; inset:0; display:none; align-items:center; justify-content:center; z-index:100000 }
    #rm-lightbox.active{ display:flex }
    #rm-lightbox .rm-backdrop{ position:absolute; inset:0; background:rgba(0,0,0,.85) }
    body.modal-open{ overflow:hidden; height:100vh }
    #rm-image{ -webkit-touch-callout:none; position:relative; max-width:100vw; max-height:100vh; transform-origin:center; touch-action:none; user-select:none; -webkit-user-drag:none; cursor:zoom-out }

    footer{ text-align:center; padding:20px; background:#e4e6c5; color:#000 }

    /* ---- MOBIL TILPASNINGER ---- */
    @media (max-width:900px){
      :root{ --social-top:116px }
      .madagascar-container{ display:none }              /* Skjul øen */
      .hero{
        display:block; position:static; width:calc(100vw - 32px);
        margin:8px auto 10px;
        /* Ekstra venstre-indrykning så tekst ikke rammer sociale ikoner */
        padding-left: calc(16px + 76px);                 /* 16px base + ~76px ikonkolonne */
      }
      /* Mindre typografi i hero */
      .hero h1{ font-size:clamp(18px,6.2vw,22px) }
      .hero .sub{ font-size:.95rem }
      .hero .pt{ font-size:.85rem; padding:5px 8px }
      .hero .btn{ padding:8px 12px; font-size:.95rem }
      .hero .perks{ font-size:.85rem }

      .content-box{ margin:12px auto 10px!important; padding:12px }
      .coin-section{ gap:16px; padding-top:10px; margin-top:6px }
      .coin{ width:180px; padding:8px; border-radius:12px }
      .coin img{ width:160px; height:160px; margin-bottom:8px }
      .coin-description{ font-size:.85rem }
    }
  </style>
</head>
<body>
  <!-- NAV -->
  <header class="site-nav">
    <div class="nav-inner">
      <nav class="nav">
        <a href="/index.html" aria-current="page" data-text="common:nav_home">Home</a>
        <a href="/madacoin.html" data-text="common:nav_about">Om</a>
        <a href="/rapporter.html" data-text="common:nav_reports">Rapporter</a>
      </nav>
    </div>
  </header>

  <!-- Social -->
  <div class="social-menu" id="social-menu"></div>

  <!-- HERO -->
  <section class="hero" id="home-hero">
    <div class="ribbon" data-text="home:hero_ribbon">NYHED: 25% hotelrabat til MCD &amp; MCN holders</div>
    <h1 data-text="home:hero_title">Donér. Byg. Forandr Madagaskar.</h1>
    <p class="sub" data-text="home:hero_sub">MadaCoin gør donationer til skoler, solenergi og lokale jobs — med fuld gennemsigtighed.</p>
    <div class="points">
      <span class="pt" data-text="home:hero_point1">Skolebyggeri</span>
      <span class="pt" data-text="home:hero_point2">Solceller &amp; batterier</span>
      <span class="pt" data-text="home:hero_point3">Åbne rapporter</span>
    </div>
    <div class="btns">
      <button class="btn primary" id="hero-primary" data-text="home:hero_cta_primary">Støt med MadaCoin</button>
      <a class="btn" href="/rapporter.html" data-text="home:hero_cta_secondary">Se rapporter</a>
    </div>
    <div class="perks">
      <span data-text="home:hero_perks_blurb">Kvalificér med <strong>≥ 5.000 MCD</strong> eller samlet <strong>≥ 5.000 USD</strong> i MCD/MCN. 1 kode pr. 60. dag. Gælder udvalgte hoteller &amp; ferieboliger i Madagaskar.</span>
      &nbsp; <a href="/perks.html" data-text="home:hero_perks_link">Se vilkår &amp; partnere</a>
    </div>
  </section>

  <!-- Øen (desktop) -->
  <div class="madagascar-container">
    <img src="https://byrlebjwknppjbtbkozt.supabase.co/storage/v1/object/sign/backgrounds/ChatGPT%20Image%2026.%20jul.%202025,%2002.34.32.png?token=eyJraWQiOiJzdG9yYWdlLXVybC1zaWduaW5nLWtleV8wZTcxMmNhYy0yZjA2LTQ2Y2YtYjRlMC1lOTcyZjJiNmQwNjEiLCJhbGciOiJIUzI1NiJ9.eyJ1cmwiOiJiYWNrZ3JvdW5kcy9DaGF0R1BUIEltYWdlIDI2LiBqdWwuIDIwMjUsIDAyLjM0LjMyLnBuZyIsImlhdCI6MTc1MzY0ODA0NCwiZXhwIjo4ODE1MzU2MTY0NH0.NgGHOp8k38S34w-iR6M3TCjEFJENQ1MRdjmpv4CLKRY" alt="Madagaskar Ø" />
  </div>

  <!-- Coins -->
  <div class="content-box">
    <section class="coin-section">
      <div class="coin">
        <img id="coinD" alt="MadaCoin Donation" />
        <p class="coin-description">Støt vores mission ved at købe MadaCoin Donation.</p>
        <button class="button" onclick="openTransak('MCD','0xa594586B04f1b6782EC906B49882EbD0E652a388')">Køb MadaCoin Donation</button>
      </div>
      <div class="coin">
        <img id="coinC" alt="MadaCoin" />
        <p class="coin-description">Investér i MadaCoin – fremtidens valuta for Madagaskar.</p>
        <button class="button" onclick="openTransak('MCN','DIN_MCN_KONTRAKT_ADRESSE')">Køb MadaCoin</button>
      </div>
    </section>
  </div>

  <!-- Roadmap -->
  <div class="roadmap" id="roadmap"></div>

  <!-- YouTube -->
  <section id="yt-section" style="margin:40px 0;">
    <div style="max-width:1000px;margin:0 auto;">
      <div id="yt-player" style="position:relative;padding-top:56.25%;border:2px solid #222;border-radius:14px;overflow:hidden;"></div>
      <div id="yt-thumbs" style="display:grid;grid-template-columns:repeat(auto-fill,minmax(110px,1fr));gap:12px;margin-top:16px;"></div>
    </div>
  </section>

  <script>
    const SUPABASE_URL="https://byrlebjwknppjbtbkozt.supabase.co";
    const SUPABASE_ANON="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJ5cmxlYmp3a25wcGpidGJrb3p0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE3NjcyNjYsImV4cCI6MjA2NzM0MzI2Nn0.3aoQMQgmxXouUfpqrwfSgcUgedjZEue6s3ZkGoqvQYY";
    const sb = window.supabase ? window.supabase.createClient(SUPABASE_URL,SUPABASE_ANON) : null;
    window.sb = sb;

    const TRANSAK_KEY="DIN_API_KEY";
    function openTransak(symbol,wallet){
      if(!TRANSAK_KEY||TRANSAK_KEY==="DIN_API_KEY"||(wallet&&wallet.includes("DIN_MCN_KONTRAKT_ADRESSE"))){
        alert("Køb-funktionen bliver aktiveret, når nøgle og kontrakt er sat."); return;
      }
      const url=`https://global.transak.com/?apiKey=${TRANSAK_KEY}&cryptoCurrencyCode=${symbol}&walletAddress=${wallet}&network=polygon&fiatCurrency=EUR&defaultPaymentMethod=credit_debit_card&themeColor=FFCC00`;
      window.open(url,"_blank","width=500,height=700");
    }

    async function loadSiteText(){
      if(!sb) return {};
      try{
        const { data, error } = await sb.from('site_text').select('page,key,value').in('page',['common','home']);
        if(error) return {};
        const dict={}; (data||[]).forEach(r=>dict[`${r.page}:${r.key}`]=r.value);
        document.querySelectorAll('[data-text]').forEach(el=>{
          const k=el.getAttribute('data-text'); if(dict[k]!=null) el.innerHTML=dict[k];
        });
        return dict;
      }catch{ return {}; }
    }

    function normalizeUrl(u){ if(!u) return null; const t=u.trim(); return /^https?:\/\//i.test(t)?t:'https://'+t }
    function iconUrlFor(p){ const name=p.charAt(0).toUpperCase()+p.slice(1).toLowerCase(); const {data}=sb.storage.from('social.icons').getPublicUrl(`${name}.svg`); return data?.publicUrl||null }
    function fallbackIconUrl(){ const {data}=sb.storage.from('social.icons').getPublicUrl('Globe.svg'); return data?.publicUrl||'' }
    async function renderSocialLinks(){
      const el=document.getElementById('social-menu'); if(!el||!sb) return;
      el.innerHTML=''; const {data,error}=await sb.from('social_links').select('platform,url,is_active,sort_order').eq('is_active',true).order('sort_order',{ascending:true});
      if(error) return; const globe=fallbackIconUrl();
      (data||[]).filter(r=>r.url&&r.url.trim()!=='').forEach(r=>{
        const a=document.createElement('a'); const href=normalizeUrl(r.url); if(!href) return;
        a.href=href; a.target='_blank'; a.rel='noopener noreferrer'; a.title=r.platform; a.setAttribute('aria-label',r.platform);
        const img=document.createElement('img'); img.src=iconUrlFor(r.platform)||globe; img.onerror=()=>{img.src=globe}; a.appendChild(img); el.appendChild(a);
      });
    }

    const base="https://byrlebjwknppjbtbkozt.supabase.co/storage/v1/object/public";
    const pub=(...p)=>`${base}/${p.map(encodeURIComponent).join('/')}`;
    function setCoinImages(){ const c=document.getElementById('coinC'), d=document.getElementById('coinD'); if(c) c.src=pub('images','MadaCoin_C.png'); if(d) d.src=pub('images','MadaCoin_D.png') }

    const buckets=["roadmap1","roadmap2","roadmap3","roadmap4"];
    const steps=[
      {title:"Køb byggegrund - Opret projekt kontor",desc:"Når målet er opfyldt, køber vi byggegrund og opretter projektkontor."},
      {title:"De første boliger bygges",desc:"Når minimum målet er opfyldt, sættes projektet i gang."},
      {title:"Solcellepark og batterier",desc:"Når målet er opnået, installerer vi solceller og batterier."},
      {title:"Byg en Skole",desc:"Byggeprojekt fra børnehave til gymnasium."}
    ];
    function renderRoadmap(){
      const root=document.getElementById('roadmap'); root.innerHTML='';
      buckets.forEach((bucket,idx)=>{
        const i=idx+1, s=steps[idx]||{title:`Roadmap ${i}`,desc:''};
        const box=document.createElement('div'); box.className='roadmap-box';
        box.innerHTML=`<h2>${s.title}</h2><p class="description">${s.desc}</p><div class="step-images" id="imgs-${i}"></div>`;
        root.appendChild(box);
        const wrap=document.getElementById(`imgs-${i}`);
        for(let k=1;k<=10;k++){
          const url=`${base}/${bucket}/Roadmap_${i}_pic_${k}.png`;
          const img=document.createElement('img'); img.alt=`Roadmap ${i} billede ${k}`; img.src=url; img.classList.add('roadmap-thumb');
          img.onerror=()=>img.remove();
          if(!img.dataset.lbBound){
            img.dataset.lbBound="1";
            img.addEventListener('click',(e)=>{ e.preventDefault(); const full=img.dataset.fullsrc||img.src; if(typeof openLightbox==='function') openLightbox(full); },{passive:false});
          }
          wrap.appendChild(img);
        }
        setTimeout(()=>{ if(!wrap.querySelector('img')) wrap.innerHTML=`<p style="color:#666;margin:6px 0;">Billeder kommer snart…</p>`; },500);
      });
    }

    function getYouTubeId(url){ if(!url) return null; try{ const u=new URL(url); if(u.hostname.includes("youtu.be")) return u.pathname.slice(1); if(u.searchParams.get("v")) return u.searchParams.get("v"); const m=url.match(/(?:embed|shorts)\/([a-zA-Z0-9_-]{6,})/); if(m) return m[1]; const seg=u.pathname.split("/").pop(); return seg&&seg.length>=6?seg:null }catch{return null} }
    function thumbUrl(id){ return `https://i.ytimg.com/vi/${id}/hqdefault.jpg` }
    function renderPlayer(id){ const el=document.getElementById("yt-player"); el.innerHTML=`<iframe src="https://www.youtube.com/embed/${id}" title="MadaCoin video" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen style="position:absolute;inset:0;width:100%;height:100%;"></iframe>` }
    function renderThumbs(videos,active){ const wrap=document.getElementById("yt-thumbs"); wrap.innerHTML=""; videos.forEach(v=>{ const id=v._id; const btn=document.createElement("button"); btn.style.background='transparent'; btn.style.border=id===active?"3px solid #f0b90b":"2px solid #333"; btn.style.borderRadius="12px"; btn.style.overflow="hidden"; btn.style.cursor="pointer"; btn.style.padding="0"; btn.title=v.title||"Se video"; btn.innerHTML=`<div style="display:flex;flex-direction:column;gap:6px"><img src="${thumbUrl(id)}" alt="${v.title||"YouTube thumbnail"}" style="display:block;width:100%;height:100%;object-fit:cover;">${v.title?`<div style="font-size:13px;line-height:1.3;color:#222;background:rgba(255,247,214,.95);padding:6px 8px;border-radius:8px;text-align:center;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;">${v.title}</div>`:""}</div>`; btn.onclick=()=>{ renderPlayer(id); [...wrap.children].forEach(c=>c.style.border="2px solid #333"); btn.style.border="3px solid #f0b90b" }; wrap.appendChild(btn) }) }
    async function initYouTube(){
      const {data,error}=await sb.from("youtube_videos").select("youtube_url,is_active,created_at,title,sort_order").eq("is_active",true).not("youtube_url","is",null).neq("youtube_url","").order("sort_order",{ascending:true,nullsFirst:false}).order("created_at",{ascending:false});
      if(error) return; const vids=(data||[]).map(v=>({...v,_id:getYouTubeId(v.youtube_url)})).filter(v=>v._id);
      if(!vids.length){ document.getElementById("yt-section").style.display="none"; return; }
      document.getElementById("yt-section").style.display=""; renderPlayer(vids[0]._id); renderThumbs(vids,vids[0]._id);
    }

    function attachHeroActions(){ const btn=document.getElementById('hero-primary'); if(btn){ btn.addEventListener('click',()=>openTransak('MCD','0xa594586B04f1b6782EC906B49882EbD0E652a388')) } }

    window.addEventListener('load', async ()=>{
      await loadSiteText(); await renderSocialLinks(); setCoinImages(); renderRoadmap(); initYouTube(); attachHeroActions();
    });
  </script>

  <script>
    /* Lightbox logic */
    let rmBox, rmImg, scale=1, tx=0, ty=0; const MIN_SCALE=1, MAX_SCALE=4;
    function applyTransform(){ if(!rmImg) return; rmImg.style.transform=`translate(${tx}px, ${ty}px) scale(${scale})` }
    function centerReset(){ scale=1; tx=0; ty=0; applyTransform() }
    function openLightbox(src){ rmImg.src=src; centerReset(); document.body.classList.add('modal-open'); rmBox.classList.add('active'); rmBox.setAttribute('aria-hidden','false') }
    function closeLightbox(){ document.body.classList.remove('modal-open'); rmBox.classList.remove('active'); rmBox.setAttribute('aria-hidden','true'); rmImg.src='' }
    function rmWheelHandler(e){ e.preventDefault(); const r=rmImg.getBoundingClientRect(); const cx=e.clientX-(r.left+r.width/2)-tx, cy=e.clientY-(r.top+r.height/2)-ty; const old=scale; const factor=Math.exp(-e.deltaY*0.0015); scale=Math.max(MIN_SCALE,Math.min(MAX_SCALE,scale*factor)); const k=scale/old; tx-=cx*(k-1); ty-=cy*(k-1); applyTransform() }
    let touchMoved=false,pinchStartDist=0,pinchStartScale=1,panStartX=0,panStartY=0,panning=false;
    function rmTouchStart(e){ touchMoved=false; if(e.touches.length===2){ const[a,b]=e.touches; pinchStartDist=Math.hypot(b.clientX-a.clientX,b.clientY-a.clientY); pinchStartScale=scale; } else if(e.touches.length===1 && scale>1){ const t=e.touches[0]; panning=true; panStartX=t.clientX-tx; panStartY=t.clientY-ty; } }
    function rmTouchMove(e){ if(e.touches.length===2){ e.preventDefault(); const[a,b]=e.touches; const d=Math.hypot(b.clientX-a.clientX,b.clientY-a.clientY); scale=Math.max(MIN_SCALE,Math.min(MAX_SCALE,pinchStartScale*(d/pinchStartDist))); applyTransform(); touchMoved=true; } else if(e.touches.length===1 && panning){ e.preventDefault(); const t=e.touches[0]; tx=t.clientX-panStartX; ty=t.clientY-panStartY; applyTransform(); touchMoved=true; } }
    function rmTouchEnd(){ panning=false; if(!touchMoved){ if(scale>1) centerReset(); else closeLightbox(); } }
    window.addEventListener('load',()=>{
      rmBox=document.getElementById('rm-lightbox'); rmImg=document.getElementById('rm-image'); if(!rmBox||!rmImg) return;
      rmBox.addEventListener('click',(e)=>{ const backdrop=e.target===rmBox||e.target.classList.contains('rm-backdrop'); const img=e.target===rmImg; if(backdrop||img) closeLightbox(); },{passive:true});
      rmImg.addEventListener('wheel',rmWheelHandler,{passive:false});
      rmImg.addEventListener('click',()=>{ if(scale>1) centerReset(); else closeLightbox(); });
      rmImg.addEventListener('touchstart',rmTouchStart,{passive:true});
      rmImg.addEventListener('touchmove',rmTouchMove,{passive:false});
      rmImg.addEventListener('touchend',rmTouchEnd,{passive:true});
      rmImg.addEventListener('contextmenu',(e)=>e.preventDefault());
    });
  </script>

  <!-- Lightbox -->
  <div id="rm-lightbox" aria-hidden="true">
    <div class="rm-backdrop"></div>
    <img id="rm-image" alt="Roadmap" />
  </div>

  <footer><span id="footer-text" data-text="common:footer">© 2025 MadaCoin. All rights reserved.</span></footer>
</body>
</html>
