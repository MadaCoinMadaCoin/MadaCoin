<!DOCTYPE html>
<html lang="da">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>MadaCoin</title>
  <meta name="description" content="MadaCoin st√∏tter udvikling i Madagaskar gennem donationer og gennemsigtighed. F√∏lg projektet og vores roadmap.">
  <link rel="icon" href="/favicon_boosted.ico?v=1" type="image/x-icon">

  <!-- Open Graph -->
  <meta property="og:title" content="MadaCoin ‚Äî Donations for Madagascar">
  <meta property="og:description" content="St√∏t udvikling i Madagaskar gennem MadaCoin.">
  <meta property="og:url" content="https://madacoin.pro">
  <meta property="og:type" content="website">

  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="MadaCoin ‚Äî Donations for Madagascar">
  <meta name="twitter:description" content="St√∏t udvikling i Madagaskar gennem MadaCoin.">

  <style>
    /* Base layout */
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      /* NOTE: Signed URL udl√∏ber senere ‚Äì ok for nu */
      background: url('https://byrlebjwknppjbtbkozt.supabase.co/storage/v1/object/sign/backgrounds/ChatGPT%20Image%2026.%20jul.%202025,%2002.39.48.png?token=eyJraWQiOiJzdG9yYWdlLXVybC1zaWduaW5nLWtleV8wZTcxMmNhYy0yZjA2LTQ2Y2YtYjRlMC1lOTcyZjJiNmQwNjEiLCJhbGciOiJIUzI1NiJ9.eyJ1cmwiOiJiYWNrZ3JvdW5kcy9DaGF0R1BUIEltYWdlIDI2LiBqdWwuIDIwMjUsIDAyLjM5LjQ4LnBuZyIsImlhdCI6MTc1MzQ5MzUwMCwiZXhwIjoxMDM5MzQwNzEwMH0.MDP85P5oLRUPvjTqFpzpaHDTgHa6Kg1pY9XDHYrve8w') no-repeat center center fixed;
      background-size: cover;
      background-attachment: fixed;
    }

    .madagascar-container {
      position: absolute;
      top: 0%;
      left: 52%;
      transform: translateX(-50%);
      z-index: 1;
    }
    .madagascar-container img {
      width: 90vw;
      max-width: 600px;
      height: auto;
      border-radius: 10px;
    }

    .social-menu {
  position: fixed;
  top: 50%;
  left: 20px;
  transform: translateY(-50%);
  display: flex;
  flex-direction: column;
  gap: 10px;
  z-index: 1000;
}

.social-menu a {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 42px;
  height: 42px;
  background-color: rgba(0, 0, 0, 0.7);
  border-radius: 8px;
  text-decoration: none;
  transition: background-color 0.2s ease, transform 0.15s ease;
}

.social-menu a:hover {
  background-color: rgba(0, 0, 0, 0.85);
  transform: translateY(-2px);
}

.social-menu a img {
  width: 22px;
  height: 22px;
}


    .menu {
      display: flex;
      justify-content: center;
      gap: 20px;
      padding: 20px;
    }
    .menu a {
      text-decoration: none;
      color: white;
      font-weight: bold;
      padding: 10px 20px;
      background-color: rgba(0, 0, 0, 0.5);
      border-radius: 5px;
    }
    .menu a:hover { background-color: rgba(0, 0, 0, 0.7); }

    .content-box {
      padding: 10px;
      padding-top: 1px;
      border-radius: 20px;
      margin-top: 400px;
      max-width: 1000px;
      margin: 400px auto 10px;
    }

    .coin-section {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 200px;
      margin-top: 10px;
      padding-top: 25px;
    }
    .coin {
      background: rgba(255, 248, 220, 0.95);
      margin: 10px;
      padding: 10px;
      border-radius: 15px;
      width: 320px;
      text-align: center;
      box-shadow: 0 0 12px rgba(0,0,0,0.1);
      border: 2px solid #e5c100;
    }
    .coin img {
      width: 300px;
      height: 300px;
      border-radius: 10px;
      margin-bottom: 10px;
      object-fit: cover;
    }
    .coin-description {
      font-size: 0.9rem;
      margin-bottom: 10px;
      color: #333;
    }

    .button {
      background: linear-gradient(135deg, #FFD700, #DAA520);
      color: #004d73 !important;
      padding: 10px 20px;
      border: none;
      margin-top: 10px;
      cursor: pointer;
      border-radius: 5px;
      font-weight: bold;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      transition: all 0.3s ease-in-out;
    }
    .button:hover { background: linear-gradient(135deg, #FFC107, #B8860B); transform: scale(1.05); }

    .roadmap {
      margin: 40px auto;
      max-width: 800px;
      padding: 0 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .roadmap-box {
      background: rgba(255, 248, 220, 0.95);
      padding: 15px 50px;
      border-radius: 20px;
      border: 2px solid #e5c100;
      box-shadow: 0 0 12px rgba(0,0,0,0.1);
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin-bottom: 30px;
      width: 100%;
      max-width: 700px;
    }
    .roadmap-box h2 { margin: 0; color: #444; font-size: 1.2rem; }
    .description { font-size: 0.8rem; margin: 0; color: #555; }
    .step-images {
      display: flex; flex-wrap: wrap; gap: 10px; max-width: 100%;
      justify-content: flex-start; margin-top: 10px;
    }
    .step-images img {
      width: 80px; height: 80px; object-fit: cover; cursor: pointer;
      margin: 5px; transition: transform 0.3s ease-in-out;
    }
   /* .step-images img:hover { transform: scale(4); z-index: 2; } */


    footer { text-align: center; padding: 20px; background: #ddd; }

    @media (max-width: 768px) {
      .madagascar-container img { width: 92vw; max-width: 520px; }
      .content-box { margin-top: 240px; padding: 12px; }
      .coin-section { gap: 24px; }
    }

/* --- Roadmap Lightbox --- */
#rm-lightbox {
  position: fixed;
  inset: 0;
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 9999;
}
#rm-lightbox.active { display: flex; }

#rm-lightbox .rm-backdrop {
  position: absolute;
  inset: 0;
  background: rgba(0,0,0,.85);
}


 /* --- LIGHTBOX: blok√©r baggrundsscroll p√• mobil --- */
body.modal-open { 
  overflow: hidden;             /* ingen scroll i baggrunden */
  height: 100vh;
}

/* Undg√• at swipe/overscroll bobler ud af overlayet */
#rm-lightbox { 
  overscroll-behavior: contain; 
}

/* S√∏rg for at ber√∏ringer ikke triggere side-gestus */
#rm-lightbox, #rm-lightbox * {
  touch-action: none;
}
    

/* Selve billedet i lightbox */
  #rm-image { -webkit-touch-callout: none; }
  position: relative;
  max-width: 100vw;
  max-height: 100vh;
  transform-origin: center center;
  touch-action: none;       /* n√∏dvendig for pinch/drag p√• mobil */
  user-select: none;
  -webkit-user-drag: none;
  cursor: zoom-out;         /* klik/tap = luk ved 1√ó */
}

/* Mark√©r dine roadmap-thumbnails med denne klasse */
.roadmap-thumb { cursor: zoom-in; }

    
  </style>
</head>
<body>

  <!-- √òVERSTE MENU -->
  
  <header class="menu">
    <nav>
      <a href="/index.html">Home</a>
      <a href="/madacoin.html">Om MadaCoin</a>
      <a href="/rapporter.html">Rapporter</a>
    </nav>
  </header>

  <!-- VENSTREMENU SOCIAL -->
  <div class="social-menu" id="social-menu"></div>




  <!-- √ò-billedet -->
  <div class="madagascar-container">
    <!-- NOTE: Signed URL udl√∏ber senere ‚Äì ok for nu -->
    <img src="https://byrlebjwknppjbtbkozt.supabase.co/storage/v1/object/sign/backgrounds/ChatGPT%20Image%2026.%20jul.%202025,%2002.34.32.png?token=eyJraWQiOiJzdG9yYWdlLXVybC1zaWduaW5nLWtleV8wZTcxMmNhYy0yZjA2LTQ2Y2YtYjRlMC1lOTcyZjJiNmQwNjEiLCJhbGciOiJIUzI1NiJ9.eyJ1cmwiOiJiYWNrZ3JvdW5kcy9DaGF0R1BUIEltYWdlIDI2LiBqdWwuIDIwMjUsIDAyLjM0LjMyLnBuZyIsImlhdCI6MTc1MzY0ODA0NCwiZXhwIjo4ODE1MzU2MTY0NH0.NgGHOp8k38S34w-iR6M3TCjEFJENQ1MRdjmpv4CLKRY"
         alt="Madagaskar √ò" />
  </div>

  <!-- M√òNTSEKTION -->
  <div class="content-box">
    <section class="coin-section">
      <div class="coin">
        <img id="coinD" alt="MadaCoin Donation" />
        <p class="coin-description">St√∏t vores mission ved at k√∏be MadaCoin Donation.</p>
        <button class="button" onclick="openTransak('MCD', '0xa594586B04f1b6782EC906B49882EbD0E652a388')">K√∏b MadaCoin Donation</button>
      </div>
      <div class="coin">
        <img id="coinC" alt="MadaCoin" />
        <p class="coin-description">Invest√©r i MadaCoin ‚Äì fremtidens valuta for Madagaskar.</p>
        <button class="button" onclick="openTransak('MCN', 'DIN_MCN_KONTRAKT_ADRESSE')">K√∏b MadaCoin</button>
      </div>
    </section>
  </div>

  <!-- ROADMAP -->
  <div class="roadmap" id="roadmap"></div>

<!-- Placeholder  for gammel youtube blok -->
  
  <script>
    /* Transak (placeholder indtil n√∏gler er p√• plads) */
    const TRANSAK_KEY = "DIN_API_KEY"; // TODO
    function openTransak(symbol, wallet) {
      if (!TRANSAK_KEY || TRANSAK_KEY === "DIN_API_KEY" || (wallet && wallet.includes("DIN_MCN_KONTRAKT_ADRESSE"))) {
        alert("K√∏b-funktionen bliver aktiveret, n√•r n√∏gle og kontrakt er sat.");
        return;
      }
      const url = `https://global.transak.com/?apiKey=${TRANSAK_KEY}&cryptoCurrencyCode=${symbol}&walletAddress=${wallet}&network=polygon&fiatCurrency=EUR&defaultPaymentMethod=credit_debit_card&themeColor=FFCC00`;
      window.open(url, "_blank", "width=500,height=700");
    }

    /* Supabase public base */
    const base = "https://byrlebjwknppjbtbkozt.supabase.co/storage/v1/object/public";

    /* Coins: forventer public filer i bucket "images":
       images/MadaCoin_C.png   og   images/MadaCoin_D.png  */
    const pub = (...p) => `${base}/${p.map(encodeURIComponent).join('/')}`;
    function setCoinImages() {
      const c = document.getElementById('coinC');
      const d = document.getElementById('coinD');
      if (c) c.src = pub('images','MadaCoin_C.png'); // case-sensitivt!
      if (d) d.src = pub('images','MadaCoin_D.png');
    }

    /* Roadmap-billeder (public buckets: roadmap1..4 med Roadmap_X_pic_Y.png) */
    const buckets = ["roadmap1", "roadmap2", "roadmap3", "roadmap4"];
    const steps = [
      { title: "K√∏b byggegrund - Opret projekt kontor", desc: "N√•r m√•let er opfyldt, k√∏ber vi byggegrund og opretter projektkontor." },
      { title: "De f√∏rste boliger bygges", desc: "N√•r minimum m√•let er opfyldt, s√¶ttes projektet i gang." },
      { title: "Solcellepark og batterier", desc: "N√•r m√•let er opn√•et, installerer vi solceller og batterier." },
      { title: "Byg en Skole", desc: "Byggeprojekt fra b√∏rnehave til gymnasium." }
    ];

    function renderRoadmap() {
      const root = document.getElementById('roadmap');
      root.innerHTML = '';

      buckets.forEach((bucket, idx) => {
        const stepIndex = idx + 1;
        const s = steps[idx] || { title: `Roadmap ${stepIndex}`, desc: '' };

        const box = document.createElement('div');
        box.className = 'roadmap-box';
        box.innerHTML = `
          <h2>${s.title}</h2>
          <p class="description">${s.desc}</p>
          <div class="step-images" id="imgs-${stepIndex}"></div>
        `;
        root.appendChild(box);

        const wrap = document.getElementById(`imgs-${stepIndex}`);

        for (let i = 1; i <= 10; i++) {
          const url = `${base}/${bucket}/Roadmap_${stepIndex}_pic_${i}.png`;
          const img = document.createElement('img');
          img.alt = `Roadmap ${stepIndex} billede ${i}`;
          img.src = url;
          
          // --- ROADMAP LIGHTBOX: g√∏r thumbnail klikbar ---
          img.classList.add('roadmap-thumb');
          img.onerror = () => img.remove();
          wrap.appendChild(img);
        }

        // Hvis ingen billeder blev vist, vis en lille tekst i stedet
        setTimeout(() => {
          if (!wrap.querySelector('img')) {
            wrap.innerHTML = `<p style="color:#666;margin:6px 0;">Billeder kommer snart‚Ä¶</p>`;
          }
        }, 500);
      });
    }

    /* Init */
    renderRoadmap();
    setCoinImages();
  </script>


<!-- YouTube (skjules automatisk hvis ingen data) -->
<section id="yt-section" style="margin:40px 0;">
  <div style="max-width:1000px;margin:0 auto;">
    <div id="yt-player" style="position:relative;padding-top:56.25%;border:2px solid #222;border-radius:14px;overflow:hidden;"></div>
    <div id="yt-thumbs" style="display:grid;grid-template-columns:repeat(auto-fill,minmax(110px,1fr));gap:12px;margin-top:16px;"></div>
  </div>
</section>


<script src="https://unpkg.com/@supabase/supabase-js@2"></script>
  
<script>
  const SUPABASE_URL = "https://byrlebjwknppjbtbkozt.supabase.co";
  const SUPABASE_ANON = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJ5cmxlYmp3a25wcGpidGJrb3p0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE3NjcyNjYsImV4cCI6MjA2NzM0MzI2Nn0.3aoQMQgmxXouUfpqrwfSgcUgedjZEue6s3ZkGoqvQYY";
  const sb = supabase.createClient(SUPABASE_URL, SUPABASE_ANON);
  
  // üëâ Tilf√∏j DENNE linje:
  window.sb = sb;
  
  function getYouTubeId(url) {
    if (!url) return null;
    try {
      const u = new URL(url);
      if (u.hostname.includes("youtu.be")) return u.pathname.slice(1);
      if (u.searchParams.get("v")) return u.searchParams.get("v");
      const m = url.match(/(?:embed|shorts)\/([a-zA-Z0-9_-]{6,})/);
      if (m) return m[1];
      const seg = u.pathname.split("/").pop();
      return seg && seg.length >= 6 ? seg : null;
    } catch { return null; }
  }

  function thumbUrl(id) {
    return `https://i.ytimg.com/vi/${id}/hqdefault.jpg`;
  }

  function renderPlayer(id) {
    const el = document.getElementById("yt-player");
    el.innerHTML = `
      <iframe
        src="https://www.youtube.com/embed/${id}"
        title="MadaCoin video"
        frameborder="0"
        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
        allowfullscreen
        style="position:absolute;inset:0;width:100%;height:100%;"
      ></iframe>`;
  }

  function renderThumbs(videos, activeId) {
    const wrap = document.getElementById("yt-thumbs");
    wrap.innerHTML = "";
    videos.forEach(v => {
      const id = v._id;
      const btn = document.createElement("button");
      btn.style.background = 'transparent';
      btn.style.border = id === activeId ? "3px solid #f0b90b" : "2px solid #333";
      btn.style.borderRadius = "12px";
      btn.style.overflow = "hidden";
      btn.style.cursor = "pointer";
      btn.style.padding = "0";
      btn.title = v.title || "Se video";
      btn.innerHTML = `
  <div style="display:flex;flex-direction:column;gap:6px">
    <img src="${thumbUrl(id)}" alt="${v.title || "YouTube thumbnail"}"
         style="display:block;width:100%;height:100%;object-fit:cover;">
    ${v.title ? `<div style="font-size:13px;line-height:1.3;color:#222;background:rgba(255,247,214,.95);padding:6px 8px;border-radius:8px;text-align:center;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;">${v.title}</div>` : ``}


`;

      btn.onclick = () => {
        renderPlayer(id);
        [...wrap.children].forEach(c => c.style.border = "2px solid #333");
        btn.style.border = "3px solid #f0b90b";
      };
      wrap.appendChild(btn);
    });
  }

  async function initYouTube() {
    const { data, error } = await sb
      .from("youtube_videos")
     .select("youtube_url,is_active,created_at,title,sort_order")
.eq("is_active", true)
.not("youtube_url", "is", null)
.neq("youtube_url", "")
.order("sort_order", { ascending: true, nullsFirst: false })
.order("created_at", { ascending: false });



    if (error) { console.error(error); return; }

    const videos = (data || [])
      .map(v => ({ ...v, _id: getYouTubeId(v.youtube_url) }))
      .filter(v => v._id);

    if (!videos.length) {
      document.getElementById("yt-section").style.display = "none";
      return;
    }

    document.getElementById("yt-section").style.display = "";
    renderPlayer(videos[0]._id);
    renderThumbs(videos, videos[0]._id);
  }

  initYouTube();

  // --- Social links menu ---
  function normalizeUrl(url) {
    if (!url) return null;
    const u = url.trim();
    if (/^https?:\/\//i.test(u)) return u;
    return 'https://' + u;
  }

  function iconUrlFor(platform) {
    const formattedName = platform.charAt(0).toUpperCase() + platform.slice(1).toLowerCase();
    const { data } = sb
      .storage
      .from('social.icons')
      .getPublicUrl(`${formattedName}.svg`);
    return data?.publicUrl || null;
  }

  function fallbackIconUrl() {
    const { data } = sb.storage.from('social.icons').getPublicUrl('Globe.svg');
    return data?.publicUrl || '';
  }

  async function renderSocialLinks() {
    const el = document.getElementById('social-menu');
    el.innerHTML = '';

    const { data, error } = await sb
      .from('social_links')
      .select('platform,url,is_active,sort_order')
      .eq('is_active', true)
      .order('sort_order', { ascending: true });

    if (error) {
      console.error('Fejl ved hentning af social_links:', error);
      return;
    }

    const globe = fallbackIconUrl();

    (data || [])
      .filter(r => r.url && r.url.trim() !== '')
      .forEach(r => {
        const platform = (r.platform || '').trim();
        const href = normalizeUrl(r.url);
        if (!href) return;

        const a = document.createElement('a');
        a.href = href;
        a.target = '_blank';
        a.rel = 'noopener noreferrer';
        a.title = platform;
        a.setAttribute('aria-label', platform);

        const img = document.createElement('img');
        img.src = iconUrlFor(platform) || globe;
        img.onerror = () => { img.src = globe; };

        a.appendChild(img);
        el.appendChild(a);
      });
  }

/* --- SOCIAL MENU (IKONER) ‚Äî INIT ON LOAD --- */
window.addEventListener('load', () => {
  // Tegn ikonmenuen, n√•r siden er klar
  renderSocialLinks();

  // Ekstra sikring: tegn igen kort efter i tilf√¶lde af overskrivninger
  setTimeout(renderSocialLinks, 500);
});
/* --- /SOCIAL MENU (IKONER) --- */




  
</script>


<script>
  async function loadFooter() {
    const el = document.getElementById('footer-text');
    if (!el || !window.sb) return;

    const lang = (navigator.language || 'en').slice(0, 2);

    // Pr√∏v f√∏rst brugerens sprog
    let { data, error } = await sb
      .from('site_text')
      .select('value')
      .eq('key', 'footer_text')
      .eq('lang', lang)
      .eq('is_active', true)
      .limit(1)
      .maybeSingle();

    // Fald tilbage til engelsk
    if ((!data || !data.value) && !error) {
      const fallback = await sb
        .from('site_text')
        .select('value')
        .eq('key', 'footer_text')
        .eq('lang', 'en')
        .eq('is_active', true)
        .limit(1)
        .maybeSingle();
      data = fallback.data;
    }

    if (data && data.value) el.textContent = data.value;
  }

  loadFooter();
</script>


  <script>
/* === ROADMAP LIGHTBOX ‚Äî START (GENINDSAT) === */

/* --- STATE & REF --- */
let rmBox, rmImg;
let scale = 1, tx = 0, ty = 0;
const MIN_SCALE = 1, MAX_SCALE = 4;

/* --- ROADMAP LIGHTBOX ‚Äî OPEN GUARD --- */
let justOpenedAt = 0;
const OPEN_GUARD_MS = 350; // ignorer klik/tap ~0,35s efter √•bning



function applyTransform() {
  if (!rmImg) return;
  rmImg.style.transform = `translate(${tx}px, ${ty}px) scale(${scale})`;
}
function centerReset() { scale = 1; tx = 0; ty = 0; applyTransform(); }
function clamp(v,a,b){ return Math.max(a, Math.min(b, v)); }

/* --- TOUCH STATE --- */
let touchMoved = false;
let pinchStartDist = 0;
let pinchStartScale = 1;
let panStartX = 0, panStartY = 0;
let panning = false;

/* --- OPEN/CLOSE --- */
function openLightbox(src) {
  rmImg.src = src;
  centerReset();                          // start centreret
  document.body.classList.add('modal-open'); // l√•s baggrundsscroll
  rmBox.classList.add('active');
  rmBox.setAttribute('aria-hidden', 'false');
  justOpenedAt = Date.now(); // s√¶t tidsstempel n√•r vi √•bner
}
function closeLightbox() {
  document.body.classList.remove('modal-open');
  rmBox.classList.remove('active');
  rmBox.setAttribute('aria-hidden', 'true');
  rmImg.src = '';
}

/* --- BIND THUMBNAILS (klik/tap √•bner) --- */
function initRoadmapLightboxPart1() {
  const thumbs = Array.from(document.querySelectorAll('.roadmap-thumb'));
  console.log('[lightbox] thumbs found:', thumbs.length);

  thumbs.forEach((img) => {
    const full = img.dataset.fullsrc || img.src;

    // PC: klik √•bner
    img.addEventListener('click', (e) => {
      e.preventDefault();
      e.stopPropagation();
      openLightbox(full);
    }, { passive: false });

    // MOBIL: robust tap (kort tid + n√¶sten ingen bev√¶gelse)
    let sx = 0, sy = 0, st = 0, moved = false;

    img.addEventListener('touchstart', (e) => {
      if (e.touches.length !== 1) return;
      const t = e.touches[0];
      sx = t.clientX; sy = t.clientY; st = Date.now(); moved = false;
    }, { passive: true });

    img.addEventListener('touchmove', (e) => {
      if (e.touches.length !== 1) return;
      const t = e.touches[0];
      if (Math.abs(t.clientX - sx) > 15 || Math.abs(t.clientY - sy) > 15) moved = true; // lidt mere tolerance
    }, { passive: true });

    // MOBIL: touchend = kort TAP ‚Üí √•bn (og stop syntetisk klik)
    img.addEventListener('touchend', (e) => {
      const dt = Date.now() - st;
      if (!moved && dt < 350) {          // lidt l√¶ngere tap-vindue
        e.preventDefault();
        e.stopPropagation();
        openLightbox(full);
      }
    }, { passive: false });
  });
}


/* --- AUTO-MARK THUMBS (img hvor src indeholder "roadmap") --- */
function markRoadmapImages() {
  const imgs = [...document.querySelectorAll('img')];
  const hits = imgs.filter(img => /roadmap/i.test(img.src));
  hits.forEach(img => img.classList.add('roadmap-thumb'));
}

/* --- PC: WHEEL ZOOM (zoom om cursor) --- */
function rmWheelHandler(e) {
  e.preventDefault();
  const rect = rmImg.getBoundingClientRect();
  const cx = e.clientX - (rect.left + rect.width/2) - tx;
  const cy = e.clientY - (rect.top  + rect.height/2) - ty;

  const old = scale;
  const factor = Math.exp(-e.deltaY * 0.0015);   // bl√∏d zoom
  scale = clamp(scale * factor, MIN_SCALE, MAX_SCALE);

  const k = scale / old;
  tx -= cx * (k - 1);
  ty -= cy * (k - 1);

  applyTransform();
}

/* --- MOBIL: PINCH + PAN + TAP --- */
function rmTouchStart(e) {
  touchMoved = false;
  if (e.touches.length === 2) {
    const [a,b] = e.touches;
    pinchStartDist  = Math.hypot(b.clientX - a.clientX, b.clientY - a.clientY);
    pinchStartScale = scale;
  } else if (e.touches.length === 1 && scale > 1) {
    const t = e.touches[0];
    panning = true;
    panStartX = t.clientX - tx;
    panStartY = t.clientY - ty;
  }
}
function rmTouchMove(e) {
  if (e.touches.length === 2) {
    e.preventDefault();
    const [a,b] = e.touches;
    const dist = Math.hypot(b.clientX - a.clientX, b.clientY - a.clientY);
    scale = clamp(pinchStartScale * (dist / pinchStartDist), MIN_SCALE, MAX_SCALE);
    applyTransform();
    touchMoved = true;
  } else if (e.touches.length === 1 && panning) {
    e.preventDefault();
    const t = e.touches[0];
    tx = t.clientX - panStartX;
    ty = t.clientY - panStartY;
    applyTransform();
    touchMoved = true;
  }
}
function rmTouchEnd() {
  panning = false;
  if (!touchMoved) {
    if (scale > 1) centerReset();
    else closeLightbox();
  }
}

/* --- INIT ON LOAD --- */
window.addEventListener('load', () => {
  rmBox = document.getElementById('rm-lightbox');
  rmImg = document.getElementById('rm-image');
  if (!rmBox || !rmImg) { console.warn('[lightbox] elements missing'); return; }

  // 1) thumbnails
  markRoadmapImages();
  initRoadmapLightboxPart1();

  // 2) overlay (klik lukker, blok√©r scroll p√• mobil)
  rmBox.addEventListener('click', (e) => {
     if (Date.now() - justOpenedAt < OPEN_GUARD_MS) return; // <‚Äî NY
    const clickedBackdrop = e.target === rmBox || e.target.classList.contains('rm-backdrop');
    const clickedImage    = e.target === rmImg;
    if (clickedBackdrop || clickedImage) closeLightbox();
  }, { passive: true });
  rmBox.addEventListener('touchmove', (e) => e.preventDefault(), { passive: false });

  // 3) billed-handlers
  rmImg.addEventListener('wheel', rmWheelHandler, { passive: false });
  rmImg.addEventListener('click', () => { 
    if (Date.now() - justOpenedAt < OPEN_GUARD_MS) return; // <‚Äî NY
    if (scale > 1) centerReset(); 
    else closeLightbox(); });
  rmImg.addEventListener('touchstart', rmTouchStart, { passive: true });
  rmImg.addEventListener('touchmove',  rmTouchMove,  { passive: false });
  rmImg.addEventListener('touchend',   rmTouchEnd,   { passive: true });
  rmImg.addEventListener('contextmenu', (e) => e.preventDefault());

  console.log('[lightbox] init done');
});
/* === ROADMAP LIGHTBOX ‚Äî SLUT === */
</script>





<!-- Lightbox til roadmap -->
<div id="rm-lightbox" aria-hidden="true">
  <div class="rm-backdrop"></div>
  <img id="rm-image" alt="Roadmap" />
</div>




  
  <footer><span id="footer-text">¬© 2025 MadaCoin. All rights reserved.</span></footer>

</body>
</html>























































