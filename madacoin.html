<!doctype html>
<html lang="da">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Om MadaCoin</title>
  <link rel="preconnect" href="https://unpkg.com" />
  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
  <style>
    :root{
      /* lærred og kolonner (Preset C) */
      --wrap: 1680px;
      --gap: 84px;
      --left-col: 520px;     /* venstre bio-kolonne */
      --center-col: 460px;   /* pyramiden (smal) */
      --right-col: 720px;    /* stor tekstkolonne */
      --right-offset: 56px;  /* skub “Vores version” lidt ned */

      /* foto-størrelser (Preset C) */
      --photo-top: 144px;    /* Julienne */
      --photo-peer: 108px;   /* Thomas + Revision */
      --photo-sub: 102px;    /* underroller */

      /* farver/stil */
      --bg:#061a2b;
      --bg-image:url('https://byrlebjwknppjbtbkozt.supabase.co/storage/v1/object/public/backgrounds/ocean.png');
      --text:#fff; --muted:#cfd3d7; --primary:#9ad4ff;
      --card:#0b0b0c; --card-border:#2a2a2a; --shadow:0 12px 26px rgba(0,0,0,.5); --radius:16px;
    }

    *{box-sizing:border-box}
    body{
      margin:0; min-height:100vh; display:flex; flex-direction:column;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Arial,sans-serif;
      color:var(--text);
      background: var(--bg) no-repeat center/cover fixed;
      background-image: var(--bg-image);
    }
    @media (max-width:900px){ body{ background-attachment:scroll } }

    /* NAV – venstre justeret */
    .site-nav{ padding:14px 18px; border-bottom:1px solid rgba(255,255,255,.06) }
    .site-nav nav{ display:flex; gap:12px; align-items:center; flex-wrap:wrap; justify-content:flex-start }
    .site-nav nav a{
      color:#fff; padding:8px 14px; border-radius:12px;
      background:#0d0d0f; border:1px solid #333; text-decoration:none; opacity:.96;
      box-shadow: inset 0 1px 0 rgba(255,255,255,.06);
    }
    .site-nav nav a:hover{ filter:brightness(1.08) }
    .site-nav nav a.active{ border-color:#555; box-shadow: inset 0 1px 0 rgba(255,255,255,.12) }

    /* tre kolonner + rækker der binder bio til billeder */
    .layout{
      max-width:var(--wrap); margin:0 auto; padding:24px;
      display:grid;
      grid-template-columns: var(--left-col) var(--center-col) var(--right-col);
      grid-template-rows: auto auto auto;  /* 1: Julienne, 2: Thomas/Revision, 3: underroller */
      gap:var(--gap);
      align-items:start;
      flex:1;
    }

    /* kort */
    .card{
      background:var(--card); border:1px solid var(--card-border); border-radius:var(--radius);
      box-shadow:var(--shadow), inset 0 1px 0 rgba(255,255,255,.06)
    }
    .card.pad{ padding:18px }
    h2{ margin:0 0 10px; font-size:clamp(18px,2.2vw,22px) }
    .muted{ color:var(--muted) }

    /* venstre kolonne – bio-kort forankret til samme rækker som billederne */
    .bio-card{ width:360px; min-height:190px; max-width:100% }
    #bio-top{ grid-column:1; grid-row:1; }
    #bio-thomas{ grid-column:1; grid-row:2; }

    /* midterkolonne (pyramiden) */
    .center-col{ grid-column:2; display:flex; flex-direction:column; align-items:center; gap:32px }
    #pyr-top{ grid-row:1; }
    #pyr-mid{ grid-row:2; }
    #pyr-sub{ grid-row:3; }

    .people-mid{ display:flex; gap:36px; align-items:flex-start; justify-content:center } /* lidt tættere */

    .person,.peer,.sub{ display:flex; flex-direction:column; align-items:center; gap:10px }

    /* fotos */
    .photo-top{
      width:var(--photo-top); height:var(--photo-top);
      border-radius:8px; background-position:50% 50%; background-size:cover; background-repeat:no-repeat;
      border:1px solid transparent;
    }
    .photo-peer, .photo-sub{
      border-radius:8px; background-position:50% 50%; background-size:cover; background-repeat:no-repeat;
      border:1px solid transparent;
    }
    .photo-peer{ width:var(--photo-peer); height:var(--photo-peer); }
    .photo-sub{ width:var(--photo-sub); height:var(--photo-sub); }
    .has-photo{ border-color:#2a2a2a; box-shadow:0 8px 22px rgba(0,0,0,.5), inset 0 1px 0 rgba(255,255,255,.04) }
    .portrait{ background-position:50% 35% }

    /* labels (guards for lange navne) */
    .label{
      min-width:192px; max-width:220px;      /* guard: hold os fra at brede os horisontalt */
      text-align:center; padding:8px 14px; border-radius:999px;
      background:#0d0d0f; border:1px solid #333; box-shadow:inset 0 1px 0 rgba(255,255,255,.06);
      line-height:1.2
    }
    .label .name, .label .title{ overflow-wrap:anywhere; white-space:normal } /* guard: bryd lange navne */
    .label .title{ opacity:.9; font-size:13px }

    /* underroller række */
    .sub-row{ display:flex; justify-content:center; gap:36px; }

    /* højre kolonne – stor permanent tekst, lidt lavere end Julienne */
    .right-col{ grid-column:3; grid-row:1 / span 3; margin-top:var(--right-offset); }
    .right-col .card{ width:100% }

    /* footer */
    .site-footer{
      margin-top:auto; padding:12px 16px; color:#fff; text-align:center;
      background:rgba(0,0,0,.75); border-top:1px solid rgba(255,255,255,.06);
    }
  </style>
</head>
<body>
  <header class="site-nav">
    <nav>
      <a href="/index.html" data-text="common:nav_home">Home</a>
      <a href="/madacoin.html" class="active" data-text="common:nav_about">Om</a>
      <a href="/rapporter.html" data-text="common:nav_reports">Rapporter</a>
    </nav>
  </header>

  <div class="layout">
    <!-- Venstre bio-kolonne (toppes med billeder via grid-rækker) -->
    <article class="card pad bio-card" id="bio-top">
      <h2 data-text="about:bio_top_title">Direktør · profil</h2>
      <div class="muted" data-text="about:bio_top">
        CM Manager for InnoGames for 10 years with up to 4 workers directly under me.
      </div>
    </article>

    <article class="card pad bio-card" id="bio-thomas">
      <h2 data-text="about:thomas_bio_title">Om Thomas</h2>
      <div class="muted" data-text="about:thomas_bio">
        CM Manager for InnoGames for 10 years with up to 4 workers directly under me.
      </div>
    </article>

    <!-- Midterkolonnen: pyramiden -->
    <section class="center-col" id="pyr-top">
      <div class="person">
        <div class="photo-top" id="photo-top" aria-label="Julienne"></div>
        <div class="label">
          <div class="name" id="name-top">Julienne</div>
          <div class="title" id="title-top">Ejer og Direktør</div>
        </div>
      </div>
    </section>

    <section class="center-col" id="pyr-mid">
      <div class="people-mid">
        <div class="peer">
          <div class="photo-peer" id="photo-mid"></div>
          <div class="label">
            <div class="name" id="name-mid">Thomas</div>
            <div class="title" id="title-mid">Adm. Direktør · Udvikler</div>
          </div>
        </div>
        <div class="peer">
          <div class="photo-peer" id="photo-accounting"></div>
          <div class="label">
            <div class="name" id="name-accounting">Revision &amp; Regnskab</div>
            <div class="title" id="title-accounting">Partner</div>
          </div>
        </div>
      </div>
    </section>

    <section class="center-col" id="pyr-sub">
      <div class="sub-row">
        <div class="sub">
          <div class="photo-sub" id="photo-sub-1"></div>
          <div class="label">
            <div class="name" id="name-sub-1">Navn</div>
            <div class="title" id="title-sub-1">Rolle</div>
          </div>
        </div>
        <div class="sub">
          <div class="photo-sub" id="photo-sub-2"></div>
          <div class="label">
            <div class="name" id="name-sub-2">Navn</div>
            <div class="title" id="title-sub-2">Rolle</div>
          </div>
        </div>
        <div class="sub">
          <div class="photo-sub" id="photo-sub-3"></div>
          <div class="label">
            <div class="name" id="name-sub-3">Navn</div>
            <div class="title" id="title-sub-3">Rolle</div>
          </div>
        </div>
      </div>
    </section>

    <!-- Højre kolonne: stor permanent tekst -->
    <aside class="right-col">
      <div class="card pad" id="right-main">
        <h2 data-text="about:right_title">Vores version</h2>
        <div class="muted" data-text="about:right_body">
          Dette er vores plads til længere tekst. Den er altid synlig og kan vokse i højden.
        </div>
      </div>
    </aside>
  </div>

  <footer class="site-footer">
    <span data-text="common:footer">© 2025 MadaCoin. All rights reserved.</span>
  </footer>

  <script>
    /* Supabase valgfri – siden falder tilbage til statisk indhold */
    (function(){
      if (window.supabase && window.SUPABASE_URL && window.SUPABASE_ANON) {
        window.sb = window.supabase.createClient(window.SUPABASE_URL, window.SUPABASE_ANON);
      } else {
        window.sb = null;
      }
    })();

    (async function(){
      var STATIC_PROJECT = 'byrlebjwknppjbtbkozt';
      var STATIC_STORAGE_BASE = 'https://' + STATIC_PROJECT + '.supabase.co/storage/v1/object/public';
      var STORAGE_BASE = (window.SUPABASE_URL && window.SUPABASE_URL.indexOf('supabase.co')>-1)
        ? window.SUPABASE_URL.replace(/\/+$/,'') + '/storage/v1/object/public'
        : STATIC_STORAGE_BASE;

      var PLACEHOLDER = 'data:image/svg+xml;utf8,%3Csvg xmlns%3D%22http%3A//www.w3.org/2000/svg%22 viewBox%3D%220 0 256 256%22%3E%3Ccircle cx%3D%22128%22 cy%3D%22128%22 r%3D%22118%22 fill%3D%22%23f7c14b%22 stroke%3D%22%236b4a0e%22 stroke-width%3D%226%22/%3E%3Ctext x%3D%2250%25%22 y%3D%2255%25%22 text-anchor%3D%22middle%22 font-family%3D%22Segoe%20UI%2CArial%22 font-size%3D%2288%22 font-weight%3D%22700%22 fill%3D%22%232b1b05%22%3EMC%3C/text%3E%3C/svg%3E';

      function fallbackBySlot(slot){
        if (slot==='top')        return STORAGE_BASE + '/people/Owner.jpg';
        if (slot==='mid')        return STORAGE_BASE + '/people/ADM.jpg';
        if (slot==='accounting') return STORAGE_BASE + '/people/Revision.jpg';
        return '';
      }
      function showPhoto(elId, slot, url){
        var el=document.getElementById(elId); if(!el) return;
        var fallback=fallbackBySlot(slot);
        var hasReal=!!(url && String(url).trim());
        var chosen=hasReal?url:(fallback||PLACEHOLDER);
        el.style.backgroundImage="url('"+chosen+"')";
        var img=new Image();
        img.onload=function(){
          if(img.naturalHeight>img.naturalWidth*1.15) el.classList.add('portrait');
          else el.classList.remove('portrait');
        }; img.src=chosen;

        var addFrame=hasReal;
        if(!hasReal && slot==='accounting' && fallback) addFrame=false;
        if(!hasReal && !fallback) addFrame=false;
        el.classList.toggle('has-photo', addFrame);
      }
      function setText(id,val){ var el=document.getElementById(id); if(el && val!=null) el.textContent=val; }

      /* Tekster fra site_text (common + about) */
      if(window.sb){
        try{
          var st=await window.sb.from('site_text').select('page,key,value').in('page',['common','about']);
          if(st && st.data){
            var dict={}; st.data.forEach(r=>dict[r.page+':'+r.key]=r.value);
            document.querySelectorAll('[data-text]').forEach(el=>{
              var k=el.getAttribute('data-text'); if(dict[k]) el.innerHTML=dict[k];
            });
          }
        }catch(e){ console.warn('[about] site_text:',e); }
      }

      /* Personer/partnere */
      if(window.sb){
        try{
          var ppl=await window.sb.from('org_people')
            .select('slot,name,title,photo_url,bio,partner_id')
            .in('slot',['top','mid','accounting','sub1','sub2','sub3']);

          var partnersById={}, ids=[];
          (ppl.data||[]).forEach(p=>{ if(p.partner_id) ids.push(p.partner_id); });
          if(ids.length){
            var pr=await window.sb.from('partners')
              .select('id,name,website,logo_url,logo_alt,category,active')
              .in('id',ids);
            (pr.data||[]).forEach(x=>partnersById[x.id]=x);
          }

          var bySlot={}; (ppl.data||[]).forEach(x=>bySlot[x.slot]=x);

          (function(){ var p=bySlot.top||{};
            showPhoto('photo-top','top',p.photo_url);
            setText('name-top',p.name||document.getElementById('name-top').textContent);
            setText('title-top',p.title||document.getElementById('title-top').textContent);
            if(p.bio){ var el=document.querySelector('#bio-top [data-text="about:bio_top"]'); if(el) el.innerHTML=p.bio; }
          })();

          (function(){ var p=bySlot.mid||{};
            showPhoto('photo-mid','mid',p.photo_url);
            setText('name-mid',p.name||document.getElementById('name-mid').textContent);
            setText('title-mid',p.title||document.getElementById('title-mid').textContent);
            if(p.bio){ var el=document.querySelector('#bio-thomas [data-text="about:thomas_bio"]'); if(el) el.innerHTML=p.bio; }
          })();

          (function(){ var p=bySlot.accounting||{};
            var partner=p.partner_id?partnersById[p.partner_id]:null;
            var name=(partner&&partner.name)||p.name||document.getElementById('name-accounting').textContent;
            var title=partner?(partner.category||'Partner'):(p.title||document.getElementById('title-accounting').textContent);
            var logo=(partner&&partner.logo_url)||p.photo_url||'';
            showPhoto('photo-accounting','accounting',logo);
            setText('name-accounting',name); setText('title-accounting',title);
          })();

          (function(){
            var rows=[
              {slot:'sub1',photo:'photo-sub-1',name:'name-sub-1',title:'title-sub-1'},
              {slot:'sub2',photo:'photo-sub-2',name:'name-sub-2',title:'title-sub-2'},
              {slot:'sub3',photo:'photo-sub-3',name:'name-sub-3',title:'title-sub-3'},
            ];
            rows.forEach(m=>{
              var p=bySlot[m.slot]||{};
              var partner=p.partner_id?partnersById[p.partner_id]:null;
              var name=(partner&&partner.name)||p.name||document.getElementById(m.name).textContent;
              var title=partner?(partner.category||'Partner'):(p.title||document.getElementById(m.title).textContent);
              var logo=(partner&&partner.logo_url)||p.photo_url||'';
              showPhoto(m.photo,'sub',logo);
              setText(m.name,name); setText(m.title,title);
            });
          })();
        }catch(e){ console.warn('[about] org_people:',e); }
      } else {
        /* uden Supabase: brug fallbacks + HTML */
        showPhoto('photo-top','top','');
        showPhoto('photo-mid','mid','');
        showPhoto('photo-accounting','accounting','');
        showPhoto('photo-sub-1','sub','');
        showPhoto('photo-sub-2','sub','');
        showPhoto('photo-sub-3','sub','');
      }
    })();
  </script>
</body>
</html>
